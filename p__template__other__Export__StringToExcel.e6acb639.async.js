(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[788],{40669:function(U,L,a){"use strict";a.r(L),a.d(L,{openExcel:function(){return h}});var m=a(66456),R=a(15885),c=a(57663),C=a(71577),P=a(88983),S=a(47933),T=a(11849),s=a(39428),v=a(3182),l=a(2824),u=a(3382),g=a(67265),t=a(67294),n=a(54701),_=a(84340),e=a(74315),d=a(85893),h=function(x,M){var A=new Blob([x],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),w=window.URL.createObjectURL(A),E=document.createElement("a");E.style.display="none",E.href=w,E.download=M||"\u6D4B\u8BD5\u6587\u4EF6",document.querySelectorAll("body")[0].appendChild(E),E.click(),E.remove()};function D(Y){var x=(0,t.useState)(!1),M=(0,l.Z)(x,2),A=M[0],w=M[1],E=(0,t.useState)(""),b=(0,l.Z)(E,2),W=b[0],Z=b[1],J=(0,t.useState)([]),j=(0,l.Z)(J,2),K=j[0],V=j[1],H=(0,t.useState)({list:[],total:0,current:1,pageSize:10}),k=(0,l.Z)(H,2),I=k[0],G=k[1];(0,t.useEffect)(function(){var p={userId:"001",pageIndex:1,pageSize:10};N(p),F()},[]);var N=function(){var p=(0,v.Z)((0,s.Z)().mark(function o(r){var i;return(0,s.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return w(!0),y.next=3,u.Z.getList(r);case 3:i=y.sent,w(!1),i&&i.success&&G({list:i.data.list,total:i.data.total,current:i.data.current,pageSize:i.data.pageSize});case 6:case"end":return y.stop()}},o)}));return function(r){return p.apply(this,arguments)}}(),F=function(){var p=(0,v.Z)((0,s.Z)().mark(function o(){var r,i,f;return(0,s.Z)().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return r=["node_status","complate_condition"],O.next=3,u.Z.getDicList(r);case 3:i=O.sent,f=i.data.map(function(B){return(0,T.Z)((0,T.Z)({},B),{},{label:B.constantKey,value:B.constantValue})}),V(f);case 6:case"end":return O.stop()}},o)}));return function(){return p.apply(this,arguments)}}(),$=function(){var o=Math.ceil(I.total/I.pageSize);return"\u603B\u5171".concat(I.total,"\u6761\u6570\u636E,\u7B2C").concat(I.current,"/").concat(o,"\u9875")},Q=function(o){var r={userId:"001",pageIndex:o.current,pageSize:o.pageSize};N(r)},X=function(){var o=z.map(function(y){return y.title}),r=n.P6.json_to_sheet([]);n.P6.sheet_add_aoa(r,[o],{origin:"A1"}),(0,_.wf)(r,6);var i=n.P6.book_new();n.P6.book_append_sheet(i,r);var f=(0,_.uf)(i);(0,_.$x)(f,"".concat(Date.now(),".xlsx"))},q=function(){var p=(0,v.Z)((0,s.Z)().mark(function o(){var r;return(0,s.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,(0,e.ZP)({headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("loginToken"))},responseType:"blob",data:JSON.stringify({appId:"",data:{},lang:"cn",operator:"",source:"PC",traceId:"",version:"1"}),url:"https://bdhtesthk.tax.deloitte.com.cn/fssc-mdm/segmentEnumValue/export",method:"post"});case 2:r=f.sent,h(r.data);case 4:case"end":return f.stop()}},o)}));return function(){return p.apply(this,arguments)}}(),z=[{title:"\u9009\u62E9",dataIndex:"action",key:"action",render:function(o,r){return(0,d.jsx)("span",{children:(0,d.jsx)(S.ZP.Group,{value:W,onChange:function(f){return Z(f.target.value)},children:(0,d.jsx)(S.ZP,{value:r.id})})})}},{title:"\u8D22\u52A1\u62A5\u8868\u7C7B\u578B",dataIndex:"ReportNm",key:"ReportNm",render:function(o){var r=K.filter(function(i){return i.constantValue===o&&i.parentId==="node_status"});return r.length>0?r[0].constantKey:""}},{title:"\u62A5\u8868\u65F6\u95F4",dataIndex:"ReportYearMonth",key:"ReportYearMonth"},{title:"\u62A5\u8868\u5468\u671F\u7C7B\u578B",dataIndex:"ReportCycleTypeCd",key:"ReportCycleTypeCd",render:function(o){var r=K.filter(function(i){return i.constantValue===o&&i.parentId==="complate_condition"});return r.length>0?r[0].constantKey:""}}];return(0,d.jsxs)(g.ZP,{loading:A,children:[(0,d.jsx)(C.Z,{type:"primary",onClick:X,children:"\u4E0B\u8F7D\u6A21\u677F"}),(0,d.jsx)(C.Z,{type:"primary",onClick:q,style:{marginLeft:"10px"},children:"\u5BFC\u51FA"}),(0,d.jsx)(R.Z,{pagination:{total:I.total,current:I.current,pageSize:I.pageSize,showSizeChanger:!0,showQuickJumper:!0,showTotal:$},dataSource:I.list,columns:z,bordered:!0,loading:A,rowKey:"id",onChange:Q,onRow:function(o){return{onClick:function(){Z(o.id)}}}})]})}L.default=D},84340:function(U,L,a){"use strict";a.d(L,{wf:function(){return C},uf:function(){return P},$x:function(){return S}});var m=a(54701),R=a(22355),c=a.n(R),C=function(s,v){for(var l=m.P6.decode_range(s["!ref"]),u=[],g=0;g<v;g++)u.push({wch:30});s["!cols"]=u;for(var t=l.s.c;t<l.e.c+1;t++)for(var n=l.s.r;n<l.e.r+1;n++){var _={c:t,r:n},e=m.P6.encode_cell(_);e==="A1"||e==="B1"||e==="C1"||e==="D1"||e==="E1"||e==="F1"||e==="G1"||e==="H1"||e==="I1"||e==="J1"||e==="K1"||e==="L1"||e==="M1"||e==="N1"||e==="O1"||e==="P1"||e==="Q1"||e==="R1"||e==="S1"||e==="T1"||e==="U1"||e==="V1"||e==="W1"||e==="X1"||e==="Y1"||e==="Z1"?s[e].s={font:{name:"Calibri",sz:11,bold:!0,color:{rgb:"ffffff"}},fill:{fgColor:{rgb:"86bc25"}}}:s[e].s={font:{name:"Calibri",sz:11}}}},P=function(s){var v={bookType:"xlsx",bookSST:!1,type:"binary"},l=R.write(s,v);function u(t){for(var n=new ArrayBuffer(t.length),_=new Uint8Array(n),e=0;e!==t.length;++e)_[e]=t.charCodeAt(e)&255;return n}var g=new Blob([u(l)],{type:"application/octet-stream"});return g},S=function(s,v){typeof s=="object"&&s instanceof Blob&&(s=URL.createObjectURL(s));var l=document.createElement("a");l.href=s,l.download=v||"";var u;window.MouseEvent?u=new MouseEvent("click"):(u=document.createEvent("MouseEvents"),u.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null)),l.dispatchEvent(u)}},3382:function(U,L,a){"use strict";a.d(L,{Z:function(){return u}});var m=a(11849),R={local:{API_URL:"https://www.fastmock.site/mock/f5d8d99de1a8ce59a932ad17a28ed974/temp"},dev:{API_URL:"https://www.fastmock.site/mock/f5d8d99de1a8ce59a932ad17a28ed974/temp"},prod:{API_URL:"https://www.fastmock.site/mock/f5d8d99de1a8ce59a932ad17a28ed974/temp"},API:{AUTH:"/auth/",BUSINESS:"/business/"}},c={LOGIN_TOKEN_STORAGE:"loginToken",BASE_URL:"https://www.fastmock.site/mock/f5d8d99de1a8ce59a932ad17a28ed974/temp",TABLE_LIST:"table_list",DIC_LIST:"dic_list",API:{AUTH:R.API.AUTH,BUSINESS:R.API.BUSINESS}},C=a(30381),P=a.n(C),S={code:0,host:"4cAFRxJHwo2Pg2iGAgzEJ/xkAj/0VjxT1iCpl2ZwluLPvev2Bms=",message:"success",success:!0,timestamp:"2022-11-07 20:53:25",traceId:"8ad100f984516cc4018452271ca6000b",data:{list:[{id:"000001",ReportCycleTypeCd:"1",ReportYearMonth:"2021-02-08 18:29:45",ReportNm:"0"},{id:"000002",ReportCycleTypeCd:"3",ReportYearMonth:"1986-09-22 15:34:32",ReportNm:"1"},{id:"000003",ReportCycleTypeCd:"2",ReportYearMonth:"2015-01-25 12:31:12",ReportNm:"1"},{id:"000004",ReportCycleTypeCd:"4",ReportYearMonth:"2002-10-27 06:41:45",ReportNm:"1"},{id:"000005",ReportCycleTypeCd:"1",ReportYearMonth:"1975-12-25 10:54:41",ReportNm:"1"},{id:"000006",ReportCycleTypeCd:"4",ReportYearMonth:"1995-11-03 08:30:29",ReportNm:"2"},{id:"000007",ReportCycleTypeCd:"4",ReportYearMonth:"2000-03-24 03:40:01",ReportNm:"2"},{id:"000008",ReportCycleTypeCd:"3",ReportYearMonth:"2003-01-07 10:39:00",ReportNm:"0"},{id:"000009",ReportCycleTypeCd:"3",ReportYearMonth:"2005-02-23 23:54:26",ReportNm:"1"},{id:"0000010",ReportCycleTypeCd:"4",ReportYearMonth:"2004-01-20 07:19:32",ReportNm:"0"},{id:"0000011",ReportCycleTypeCd:"2",ReportYearMonth:"1981-08-08 07:40:03",ReportNm:"1"}],pageSize:10,total:11,current:1}};S.data.pageSize=10,S.data.total=S.data.list.length,S.data.current=1;var T=S,s={code:0,success:!0,message:"success",traceId:"8ad100f984516cc4018461370850031f",host:"y9ZoyVZO+ZRGLSyjRCPGAyoPAo/E/SQrfxh1OX1CFEOmDt2OrrQ=",timestamp:"2022-11-10 19:05:07",data:[{id:"node_processed",parentId:"node_status",constantKey:"\u8D44\u4EA7\u8D1F\u503A\u8868",constantValue:"0",description:"\u8D44\u4EA7\u8D1F\u503A\u8868",createUser:null,constantRank:null,createTime:"2022-06-21 11:14:05",updateTime:null},{id:"node_pending",parentId:"node_status",constantKey:"\u73B0\u91D1\u6D41\u91CF\u8868",constantValue:"1",description:"\u73B0\u91D1\u6D41\u91CF\u8868",createUser:null,constantRank:null,createTime:"2022-06-21 11:14:05",updateTime:null},{id:"node_in_process",parentId:"node_status",constantKey:"\u5229\u6DA6\u53CA\u5229\u6DA6\u5206\u914D\u8868",constantValue:"2",description:"\u5229\u6DA6\u53CA\u5229\u6DA6\u5206\u914D\u8868",createUser:null,constantRank:null,createTime:"2022-06-21 11:14:05",updateTime:null},{id:"node_rejected",parentId:"node_status",constantKey:"\u8D22\u52A1\u6307\u6807\u8868",constantValue:"3",description:"\u8D22\u52A1\u6307\u6807\u8868",createUser:null,constantRank:0,createTime:null,updateTime:null},{id:"all",parentId:"complate_condition",constantKey:"\u7B2C\u4E00\u5B63\u5EA6",constantValue:"1",description:"\u7B2C\u4E00\u5B63\u5EA6",createUser:"",constantRank:0,createTime:"2022-07-05 16:59:05",updateTime:"2022-07-05 16:59:07"},{id:"half",parentId:"complate_condition",constantKey:"\u7B2C\u4E8C\u5B63\u5EA6",constantValue:"2",description:"\u7B2C\u4E8C\u5B63\u5EA6",createUser:"",constantRank:1,createTime:"2022-07-05 16:59:05",updateTime:"2022-07-05 16:59:07"},{id:"any",parentId:"complate_condition",constantKey:"\u7B2C\u4E09\u5B63\u5EA6",constantValue:"3",description:"\u7B2C\u4E09\u5B63\u5EA6",createUser:"",constantRank:2,createTime:"2022-07-05 16:59:05",updateTime:"2022-07-05 16:59:07"},{id:"custom",parentId:"complate_condition",constantKey:"\u7B2C\u56DB\u5B63\u5EA6",constantValue:"4",description:"\u7B2C\u56DB\u5B63\u5EA6",createUser:null,constantRank:3,createTime:null,updateTime:null}]},v=s,l={getTableList:function(t){return new Promise(function(n,_){localStorage.getItem(c.TABLE_LIST)||localStorage.setItem(c.TABLE_LIST,JSON.stringify(T)),n(JSON.parse(localStorage.getItem(c.TABLE_LIST)))})},getList:function(t){return console.log("options",t),new Promise(function(n,_){localStorage.getItem(c.TABLE_LIST)||localStorage.setItem(c.TABLE_LIST,JSON.stringify(T));var e=JSON.parse(localStorage.getItem(c.TABLE_LIST)),d=Math.ceil(e.data.total/t.pageSize);if(d<1){n((0,m.Z)((0,m.Z)({},e),{},{data:{pageSize:t.pageSize,list:[],total:0,current:1}}));return}if(t.pageIndex===1){n((0,m.Z)((0,m.Z)({},e),{},{data:{pageSize:t.pageSize,list:e.data.list.filter(function(h,D){return D<t.pageIndex*t.pageSize}),total:e.data.total,current:t.pageIndex}}));return}n((0,m.Z)((0,m.Z)({},e),{},{data:{pageSize:t.pageSize,list:e.data.list.filter(function(h,D){return D>=(t.pageIndex-1)*t.pageSize&&D<t.pageIndex*t.pageSize}),total:e.data.total,current:t.pageIndex}}))})},getDicList:function(t){return new Promise(function(n,_){localStorage.getItem(c.DIC_LIST)||localStorage.setItem(c.DIC_LIST,JSON.stringify(v)),n(JSON.parse(localStorage.getItem(c.DIC_LIST)))})},addList:function(t){return new Promise(function(n,_){var e=JSON.parse(localStorage.getItem(c.TABLE_LIST)),d=(0,m.Z)((0,m.Z)({},t),{},{id:Date.now().toString()});e.data.list.unshift(d),e.data.total=e.data.list.length,localStorage.setItem(c.TABLE_LIST,JSON.stringify(e)),n({code:0,data:null,message:"\u64CD\u4F5C\u6210\u529F",success:!0,timestamp:P()().format("YYYY-MM-DD HH:mm:ss"),traceId:"8ad100f984516cc4018452271ca6000b"})})},editList:function(t){return new Promise(function(n,_){var e=JSON.parse(localStorage.getItem(c.TABLE_LIST)),d=e.data.list.map(function(h){return h.id===t.id?t:h});e.data.list=d,e.data.total=d.length,localStorage.setItem(c.TABLE_LIST,JSON.stringify(e)),n({code:0,data:null,message:"\u64CD\u4F5C\u6210\u529F",success:!0,timestamp:P()().format("YYYY-MM-DD HH:mm:ss"),traceId:"8ad100f984516cc4018452271ca6000b"})})},deleteList:function(t){return new Promise(function(n,_){var e=JSON.parse(localStorage.getItem(c.TABLE_LIST));e.data.list=e.data.list.filter(function(d){return d.id!==t}),e.data.total=e.data.list.length,localStorage.setItem(c.TABLE_LIST,JSON.stringify(e)),n({code:0,data:null,message:"\u64CD\u4F5C\u6210\u529F",success:!0,timestamp:P()().format("YYYY-MM-DD HH:mm:ss"),traceId:"8ad100f984516cc4018452271ca6000b"})})}},u=l},80950:function(){},46601:function(){},89214:function(){},96419:function(){},56353:function(){},8623:function(){},7748:function(){},85568:function(){},69386:function(){},31616:function(){},56619:function(){},77108:function(){},52361:function(){},94616:function(){},55792:function(){},20067:function(){}}]);
